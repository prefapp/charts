---
{{- /*
Load the allowed features from the values.yaml file.
*/ -}}
{{- $allowed_features := .Values.allowed_features -}}

{{- /*
Validate that the feature.name is one of the allowed values.
*/ -}}
{{- range .Values.features }}
  {{- if not (has .name $allowed_features) -}}
    {{- fail (printf "Feature name '%s' is not allowed. Allowed feature names are:\n- %s" .name (join "\n- " $allowed_features)) -}}
  {{- end -}}
{{- end }}
