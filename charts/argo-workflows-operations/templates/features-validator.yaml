---
{{- /*
Load the allowed features from the features-allowed.yaml file.
*/ -}}
{{- $allowed_features := fromYaml (include "argo-workflows-operations/templates/features-allowed.yaml" .) -}}

{{- /*
Validate that the feature.name is one of the allowed values.
*/ -}}
{{- range .Values.features }}
  {{- if not (has .name $allowed_features.allowed_features) -}}
    {{- fail (printf "Feature name '%s' is not allowed. Allowed feature names are:\n- %s" .name (join "\n- " $allowed_features.allowed_features)) -}}
  {{- end -}}
{{- end }}
